@model App.Controllers.MainContentController.CategoryPostsViewModel

@{
    Layout = "_MainContentLayout";
    ViewData["Title"] = "Kết quả tìm kiếm";
    ViewBag.NavLink = "Stories";

    var pagingmodel = new PagingModel();
    if (Model.Posts != null && Model.Posts.Any())
    {
        pagingmodel.currentpage = Model.currentPage;
        pagingmodel.countpages = Model.countPages;
        pagingmodel.generateUrl = (int? p) => Url.Action("SearchPosts", new
        {
            p = p,
            query = ViewBag.Query,
            searchCategory = ViewBag.SearchCategory
        }) ?? "";
    }
}

@section MainContentSidebar {
    @await Component.InvokeAsync("MainContentSidebar")
}

<div class="search-result">
    @if (Model.Posts == null || !Model.Posts.Any())
    {
        <p class="text-center">Không tìm thấy kết quả nào</p>
    }
    else
    {
        <p class="title-page">Kết quả tìm kiếm cho từ khóa "<strong>@ViewBag.Query</strong>"</p>
        <partial name="_Paging" model="@pagingmodel" />

        @foreach (var post in Model.Posts)
        {
            <div class="d-flex post-content">
                <div class="col-md-10 d-flex">
                    <a asp-area="" asp-controller="Post" asp-action="Index" asp-route-slugPost="@post.Slug" class="post-thumb"
                        title="@post.Description">
                        <img src="/maincontent/Thumbnail?postId=@post.Id" alt="Thumbnail" class="me-3">
                    </a>
                    <div>
                        <a asp-area="" asp-controller="Post" asp-action="Index" asp-route-slugPost="@post.Slug"
                            class="post-title" title="@post.Description">
                            @post.Title
                        </a>
                        <p class="text-muted post-author">
                            <a asp-area="" asp-controller="Profile" asp-action="Index" asp-route-id="@post.AuthorId">
                                <img src="@post.AvatarPath" alt="avatar" class="avatar" />
                                @post.Author
                            </a>
                            <span>&bull; @post.DateCreated</span>
                        </p>
                    </div>
                </div>

                <div class="col-md-2">
                    <p class='post-likes'><i class="fas fa-heart"></i> Lượt thích: @post.NumLikes</p>
                    <p class='post-comments'><i class="fas fa-comments"></i> Bình luận: @post.NumComments</p>
                </div>
            </div>
        }
        <partial name="_Paging" model="@pagingmodel" />
    }
</div>

@section MainContentSidebarScripts {
    <link rel="stylesheet" href="~/css/search-posts.min.css" asp-append-version="true" />
}